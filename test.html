<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mapa Astrológico — Header</title>
<style>
  :root{
    --header-h: 120px;
    --sign-gap: 1px;
    --max-planet: 80;
  }
  body{
    margin:0;
    background:#000;
    color:#fff;
    font-family:"Futura", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:100vh;
  }

  .astro-header{
    width:100%;
    max-width:1400px;
    height:var(--header-h);
    display:grid;
    grid-template-columns:repeat(12,1fr);
    gap:var(--sign-gap);
    border-radius:8px;
    overflow:hidden;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow:0 6px 30px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
  }

  .sign {
    position:relative;
    display:flex;
    align-items:center;
    justify-content:center;
    background: rgba(255,255,255,0.01);
    border-right:1px solid rgba(255,255,255,0.01);
  }

  .sign .label {
    position:absolute;
    left:8px;
    top:6px;
    font-size:17px;
    font-family:"Futura", sans-serif;
    opacity:0.85;
    pointer-events:none;
  }

  .planet {
    position:absolute;
    border-radius:50%;
    box-shadow:0 6px 18px rgba(0,0,0,0.5), inset -6px -8px 12px rgba(0,0,0,0.35);
    transition: all 1.2s cubic-bezier(.2,.9,.2,1);
  }

  /* Planetas */
  .planet.sun {
    background: radial-gradient(circle at 30% 30%, #fff6b0 0%, #ffd54f 40%, #ff8f00 70%, #ff6f00 100%);
    box-shadow: 0 0 60px rgba(255,160,50,0.75);
  }
  .planet.moon {
    background: radial-gradient(circle at 30% 30%, #fff 0%, #bbb 70%, #888 100%);
    opacity: 0.9;
  }
  .planet.mercury{ background: radial-gradient(circle at 30% 30%, #b4a690 0%, #726b5f 100%); }
  .planet.venus{ background: radial-gradient(circle at 40% 40%, #f8eab0 0%, #b77f30 100%); }
  .planet.mars{ background: radial-gradient(circle at 35% 35%, #ffb080 0%, #b04020 100%); }
  .planet.jupiter{
    background: repeating-linear-gradient(10deg,#f8e0b0 0%,#e0b080 8%,#d7a071 16%,#c48f65 24%,#f0d0a0 32%);
  }
  .planet.jupiter::after{
    content:"";
    position:absolute;
    width:28%;
    height:18%;
    top:60%;
    left:58%;
    border-radius:50%/60%;
    background: radial-gradient(circle at 40% 40%, #ff7640 0%, #b33515 60%, rgba(80,20,0,0.85) 100%);
    box-shadow:0 0 8px rgba(255,100,50,0.6);
  }
  .planet.saturn {
    background: radial-gradient(circle at 40% 40%, #f8e8b0 0%, #d6b25f 60%, #9b7b3a 100%);
  }
  .planet.saturn::before{
    content:"";
    position:absolute;
    width:400%;
    height:140%;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%) rotateX(65deg) rotateZ(25deg);
    border-radius:50%;
    background: repeating-linear-gradient(90deg, rgba(240,210,140,0.8) 0%, rgba(180,140,90,0.6) 10%, rgba(255,255,255,0.1) 20%);
    opacity:0.9;
    mix-blend-mode:screen;
  }
  .planet.uranus{ background: radial-gradient(circle at 30% 30%, #a0e8f8 0%, #458ab0 100%); }
  .planet.neptune{ background: radial-gradient(circle at 30% 30%, #4ab0ff 0%, #1a237e 100%); }
  .planet.pluto{ background: radial-gradient(circle at 30% 30%, #d9c9b0 0%, #6b5a4a 100%); }

  @media (max-width:420px){
    :root{ --header-h: 90px; --max-planet: 56; }
  }
  @media (min-width:1024px){
    :root{ --header-h: 140px; --max-planet: 90; }
  }
</style>
</head>
<body>

<div class="astro-header" id="astroHeader"></div>

<script>
/* Símbolos zodiacales Unicode */
const SIGNS = [
  '♈','♉','♊','♋','♌','♍','♎','♏','♐','♑','♒','♓'
];

/* Configuración planetaria */
const BODIES = [
  { id:'sun', cssClass:'sun', maxSizeFactor:1.00 },
  { id:'moon', cssClass:'moon', maxSizeFactor:0.75 },
  { id:'mercury', cssClass:'mercury', maxSizeFactor:0.44 },
  { id:'venus', cssClass:'venus', maxSizeFactor:0.68 },
  { id:'mars', cssClass:'mars', maxSizeFactor:0.5 },
  { id:'jupiter', cssClass:'jupiter', maxSizeFactor:0.88 },
  { id:'saturn', cssClass:'saturn', maxSizeFactor:0.75 },
  { id:'uranus', cssClass:'uranus', maxSizeFactor:0.68 },
  { id:'neptune', cssClass:'neptune', maxSizeFactor:0.65 },
  { id:'pluto', cssClass:'pluto', maxSizeFactor:0.35 }
];

const header = document.getElementById('astroHeader');

/* Construir el grid zodiacal */
SIGNS.forEach((s, i) => {
  const div = document.createElement('div');
  div.className = 'sign';
  div.dataset.index = i;
  const label = document.createElement('div');
  label.className = 'label';
  label.textContent = s;
  div.appendChild(label);
  header.appendChild(div);
});

/* Función auxiliar */
function lonToSign(lon){ return Math.floor(((lon % 360) + 360) % 360 / 30); }
function getMaxPlanetPx(){ return parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--max-planet')) || 80; }

/* Obtener posiciones desde API real con fallback */
async function getPlanetPositions(){
  try{
    const res = await fetch("https://api.le-systeme-solaire.net/rest/bodies/");
    if(!res.ok) throw new Error("API error");
    const data = await res.json();
    const pos = {};
    for(const body of BODIES){
      const found = data.bodies.find(b => b.englishName.toLowerCase() === body.id);
      pos[body.id] = { lon: Math.random()*360 }; // placeholder: API no provee longitudes exactas
    }
    return pos;
  }catch{
    // Fallback simple para evitar errores si la API no entrega coordenadas exactas
    const now = new Date();
    const EPOCH = new Date("2000-01-01T12:00:00Z");
    const msPerDay = 86400000;
    const days = (now - EPOCH) / msPerDay;
    const period = {sun:365,moon:27,mercury:88,venus:225,mars:687,jupiter:4333,saturn:10759,uranus:30688,neptune:60182,pluto:90560};
    const base = {sun:280,moon:218,mercury:252,venus:182,mars:355,jupiter:34,saturn:50,uranus:314,neptune:304,pluto:238};
    const pos = {};
    for(const b of BODIES){
      const lon = (base[b.id] + (360/period[b.id])*days)%360;
      pos[b.id] = { lon };
    }
    return pos;
  }
}

/* Renderizar planetas */
async function renderPlanets(){
  const positions = await getPlanetPositions();
  document.querySelectorAll('.planet').forEach(p => p.remove());
  const maxPx = getMaxPlanetPx();
  for(const b of BODIES){
    const signIdx = lonToSign(positions[b.id].lon);
    const signEl = document.querySelector(`.sign[data-index="${signIdx}"]`);
    const el = document.createElement('div');
    el.className = `planet ${b.cssClass}`;
    const size = Math.round(maxPx * b.maxSizeFactor);
    el.style.width = el.style.height = size + "px";
    el.style.left = `calc(${(positions[b.id].lon % 30)/30*100}% )`;
    el.style.top = "50%";
    el.style.transform = "translate(-50%,-50%)";
    signEl.appendChild(el);
  }
}

/* Actualizar cada minuto */
renderPlanets();
setInterval(renderPlanets, 60000);
</script>

</body>
</html>
